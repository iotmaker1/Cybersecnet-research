```CVE CTI Join```
(index=data sourcetype="dessertlab-mitrecve-cti") OR (index="dev" sourcetype IN ("newbee*", "wm*"))
| rex field=_raw "[cveCVE-](?<CVE_ID>\d{4}-\d{4,})"
| rex field=_raw "(?i)(?<ttpID>T\d{4})"
| eval ttpID=upper(ttpID)
| eval CVE_ID="CVE-".CVE_ID
| where isnotnull(CVE_ID) AND isnotnull(ttpID)
| lookup mitre_tectacmap3.csv Tech# as ttpID output Tactics
| where isnotnull(Tactics)
| eval ctiscore=case(
like(_raw,"%mali%"),"3",
like(_raw,"%APT%"),"5",
true(), "2")
| eval ctatype=case(ctiscore="5","APT",ctiscore="3","Malware",ctiscore="2","Cybercrime")
| table CVE_ID, ttpID, Tactics, ctiscore, ctatype
| stats count by CVE_ID, ttpID, Tactics, ctiscore, ctatype
| sort - count
```| fields - count```
