# CSV/JSON Datasets: APT Threat Actor to CVE Mapping

## Direct Download Datasets

### 1. MITRE ATT&CK STIX Data (JSON)
**Repository:** [mitre-attack/attack-stix-data](https://github.com/mitre-attack/attack-stix-data)
**Format:** JSON (STIX 2.0/2.1)
**Direct Downloads:**
```
Enterprise: https://raw.githubusercontent.com/mitre-attack/attack-stix-data/master/enterprise-attack/enterprise-attack.json
Mobile: https://raw.githubusercontent.com/mitre-attack/attack-stix-data/master/mobile-attack/mobile-attack.json
ICS: https://raw.githubusercontent.com/mitre-attack/attack-stix-data/master/ics-attack/ics-attack.json
```

**Data Structure:**
- **Groups:** APT threat actors with aliases and descriptions
- **Techniques:** MITRE ATT&CK techniques used by groups  
- **Relationships:** Links between groups and techniques
- **Software:** Malware/tools used by threat actors

**Sample Group Entry:**
```json
{
  "type": "intrusion-set",
  "id": "intrusion-set--899ce53f-13a0-479b-a0e4-67d46e241542",
  "name": "APT29",
  "aliases": ["APT29", "YTTRIUM", "The Dukes", "Cozy Bear"],
  "description": "APT29 is threat group that has been attributed to Russia's Foreign Intelligence Service...",
  "external_references": [
    {
      "source_name": "mitre-attack",
      "url": "https://attack.mitre.org/groups/G0016",
      "external_id": "G0016"
    }
  ]
}
```

---

### 2. CVE-to-ATT&CK Mapping (JSON)
**Repository:** [center-for-threat-informed-defense/attack_to_cve](https://github.com/center-for-threat-informed-defense/attack_to_cve)
**Status:** ⚠️ Migrated to [Mappings Explorer](https://center-for-threat-informed-defense.github.io/mappings-explorer/)
**Format:** JSON
**Direct Download:**
```
https://raw.githubusercontent.com/center-for-threat-informed-defense/attack_to_cve/main/mappings/cve_to_attack.json
```

**Data Structure:**
- CVE ID mapped to ATT&CK techniques
- Confidence scores for mappings
- Technique context and relationships

---

### 3. Categorized Adversary TTPs Dataset (CSV/JSON)
**Repository:** [tropChaud/Categorized-Adversary-TTPs](https://github.com/tropChaud/Categorized-Adversary-TTPs)
**Format:** CSV, JSON
**Direct Downloads:**
```
CSV: https://raw.githubusercontent.com/tropChaud/Categorized-Adversary-TTPs/main/Categorized_Adversary_TTPs.csv
JSON: https://raw.githubusercontent.com/tropChaud/Categorized-Adversary-TTPs/main/Categorized_Adversary_TTPs.json
```

**Features:**
- Merge of MITRE ATT&CK and ETDA/ThaiCERT Threat Actor Cards
- Victim/motivation-adversary-technique pivoting
- 130+ actor group profiles
- Categorized by motivation (Espionage, Financial crime, etc.)

**CSV Columns:**
```
Actor_Name, Aliases, Country, Motivation, Sector_Targets, TTPs, Associated_CVEs, First_Observed, Last_Activity
```

---

### 4. Attack Technique Dataset (JSON)
**Repository:** [NewBee119/Attack-Technique-Dataset](https://github.com/NewBee119/Attack-Technique-Dataset)
**Format:** JSON
**Direct Download:**
```
https://raw.githubusercontent.com/NewBee119/Attack-Technique-Dataset/master/attackmitre.json
```

**Content:**
- APT group related articles and MITRE ATT&CK technique descriptions
- Structured threat intelligence reports
- Group-technique associations

---

### 5. Open Source Threat Intel Feeds (CSV)
**Repository:** [Bert-JanP/Open-Source-Threat-Intel-Feeds](https://github.com/Bert-JanP/Open-Source-Threat-Intel-Feeds)
**Format:** CSV
**Direct Download:**
```
https://raw.githubusercontent.com/Bert-JanP/Open-Source-Threat-Intel-Feeds/main/ThreatIntelFeeds.csv
```

**Features:**
- Multiple types including IP, URL, CVE and Hash indicators
- Regularly updated threat intelligence feeds
- Attribution information where available

---

### 6. CVE Database (JSON)
**Repository:** [CVEProject/cvelistV5](https://github.com/CVEProject/cvelistV5)
**Format:** JSON (CVE JSON 5.0)
**Note:** Legacy CSV format no longer supported as of June 30, 2024

**Bulk Downloads:**
```
https://github.com/CVEProject/cvelistV5/tree/main/cves
```

**Structure:** Year/CVE-YYYY-NNNNN.json format

---

### 7. APT & CyberCriminal Campaign Collections
**Repository:** [CyberMonitor/APT_CyberCriminal_Campagin_Collections](https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections)
**Format:** Mixed (Markdown, JSON references)
**Access:** APT & CyberCriminal Campaign Collection with extensive documentation

---

## Data Processing Scripts

### Python Script: Merge APT Groups with CVE Data
```python
import json
import requests
import pandas as pd
from datetime import datetime

def fetch_mitre_attack_groups():
    """Fetch MITRE ATT&CK groups data"""
    url = "https://raw.githubusercontent.com/mitre-attack/attack-stix-data/master/enterprise-attack/enterprise-attack.json"
    response = requests.get(url)
    data = response.json()
    
    groups = []
    for obj in data['objects']:
        if obj['type'] == 'intrusion-set':
            groups.append({
                'id': obj.get('external_references', [{}])[0].get('external_id', ''),
                'name': obj.get('name', ''),
                'aliases': obj.get('aliases', []),
                'description': obj.get('description', ''),
                'created': obj.get('created', ''),
                'modified': obj.get('modified', '')
            })
    return groups

def fetch_cve_data():
    """Fetch recent CVE data"""
    # This would typically connect to NVD API or other CVE sources
    # Example implementation for demonstration
    url = "https://services.nvd.nist.gov/rest/json/cves/2.0"
    headers = {'apiKey': 'YOUR_API_KEY'}  # Replace with actual API key
    response = requests.get(url, headers=headers)
    return response.json()

def create_apt_cve_mapping():
    """Create APT to CVE mapping dataset"""
    groups = fetch_mitre_attack_groups()
    
    # Sample mapping - in practice, this would come from threat intelligence
    apt_cve_mappings = [
        {
            'apt_group': 'APT29',
            'aliases': ['Cozy Bear', 'The Dukes'],
            'cve_id': 'CVE-2023-23397',
            'exploitation_date': '2024-01-10',
            'confidence': 'High',
            'source': 'Microsoft Threat Intelligence'
        },
        {
            'apt_group': 'Lazarus Group',
            'aliases': ['HIDDEN COBRA', 'APT38'],
            'cve_id': 'CVE-2023-42793',
            'exploitation_date': '2024-01-18',
            'confidence': 'High',
            'source': 'Cybersecurity Advisory'
        }
    ]
    
    # Convert to DataFrame and save as CSV
    df = pd.DataFrame(apt_cve_mappings)
    df.to_csv('apt_cve_mapping.csv', index=False)
    
    # Save as JSON
    with open('apt_cve_mapping.json', 'w') as f:
        json.dump(apt_cve_mappings, f, indent=2)
    
    return df

if __name__ == "__main__":
    mapping_df = create_apt_cve_mapping()
    print("APT-CVE mapping dataset created successfully!")
    print(mapping_df.head())
```

---

### Bash Script: Download All Datasets
```bash
#!/bin/bash

# Create directory structure
mkdir -p datasets/{mitre,cve,threat_intel}

echo "Downloading MITRE ATT&CK data..."
wget -O datasets/mitre/enterprise-attack.json https://raw.githubusercontent.com/mitre-attack/attack-stix-data/master/enterprise-attack/enterprise-attack.json
wget -O datasets/mitre/mobile-attack.json https://raw.githubusercontent.com/mitre-attack/attack-stix-data/master/mobile-attack/mobile-attack.json

echo "Downloading Categorized Adversary TTPs..."
wget -O datasets/threat_intel/categorized_adversary_ttps.csv https://raw.githubusercontent.com/tropChaud/Categorized-Adversary-TTPs/main/Categorized_Adversary_TTPs.csv
wget -O datasets/threat_intel/categorized_adversary_ttps.json https://raw.githubusercontent.com/tropChaud/Categorized-Adversary-TTPs/main/Categorized_Adversary_TTPs.json

echo "Downloading Attack Technique Dataset..."
wget -O datasets/mitre/attack_techniques.json https://raw.githubusercontent.com/NewBee119/Attack-Technique-Dataset/master/attackmitre.json

echo "Downloading Threat Intel Feeds..."
wget -O datasets/threat_intel/threat_intel_feeds.csv https://raw.githubusercontent.com/Bert-JanP/Open-Source-Threat-Intel-Feeds/main/ThreatIntelFeeds.csv

echo "All datasets downloaded successfully!"
```

---

## Data Schema Examples

### APT Group Schema (JSON)
```json
{
  "apt_groups": [
    {
      "id": "G0016",
      "name": "APT29",
      "aliases": ["Cozy Bear", "The Dukes", "YTTRIUM"],
      "country": "Russia",
      "first_observed": "2008",
      "last_activity": "2024-01-15",
      "motivation": ["Espionage", "Government"],
      "sectors_targeted": ["Government", "Defense", "Healthcare"],
      "associated_cves": [
        {
          "cve_id": "CVE-2023-23397",
          "severity": "Critical",
          "exploitation_date": "2024-01-10",
          "confidence": "High",
          "technique_mapping": ["T1566.001", "T1059.001"]
        }
      ],
      "mitre_techniques": ["T1566.001", "T1059.001", "T1055"],
      "risk_score": 95
    }
  ]
}
```

### CVE Mapping Schema (CSV)
```csv
APT_Group,Aliases,CVE_ID,CVSS_Score,Exploitation_Date,Confidence,Source,Techniques,Sectors
APT29,"Cozy Bear,The Dukes",CVE-2023-23397,9.8,2024-01-10,High,Microsoft,"T1566.001,T1059.001","Government,Defense"
Lazarus Group,"HIDDEN COBRA,APT38",CVE-2023-42793,9.8,2024-01-18,High,CISA,"T1566.002,T1204.002","Financial,Crypto"
```

---

## API Integration Examples

### MITRE ATT&CK API Usage
```python
import requests
import json

def get_group_techniques(group_id):
    """Get techniques used by specific APT group"""
    url = f"https://attack.mitre.org/api/v2/groups/{group_id}/techniques"
    response = requests.get(url)
    return response.json()

def get_cve_attack_mapping():
    """Get CVE to ATT&CK technique mappings"""
    url = "https://raw.githubusercontent.com/center-for-threat-informed-defense/mappings-explorer/main/src/assets/data/cve_to_attack.json"
    response = requests.get(url)
    return response.json()
```

---

## Data Quality and Limitations

### Coverage Analysis
- **MITRE ATT&CK:** 130+ tracked threat groups with comprehensive technique mappings
- **CVE Coverage:** Primary focus on actively exploited vulnerabilities
- **Attribution Confidence:** Varies by source and intelligence quality
- **Update Frequency:** MITRE data updated regularly, CVE mappings less frequent

### Data Validation Recommendations
1. **Cross-reference multiple sources** for higher confidence
2. **Verify temporal accuracy** of exploitation dates
3. **Check source credibility** and confidence scores
4. **Validate technique mappings** against latest ATT&CK framework

---

## Automation Tools

### Data Collection Pipeline
```yaml
# GitHub Actions workflow for automated data collection
name: Update APT-CVE Dataset
on:
  schedule:
    - cron: '0 0 * * 1'  # Weekly updates
  
jobs:
  update-dataset:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - name: Download MITRE data
        run: |
          wget -O data/mitre-attack.json https://raw.githubusercontent.com/mitre-attack/attack-stix-data/master/enterprise-attack/enterprise-attack.json
      - name: Process and merge data
        run: python scripts/merge_datasets.py
      - name: Commit updates
        run: |
          git add data/
          git commit -m "Automated dataset update"
          git push
```

---

## Commercial Alternatives

### Paid Threat Intelligence Platforms
- **Recorded Future:** API access to threat actor-CVE correlations
- **CrowdStrike Falcon Intelligence:** Comprehensive APT tracking
- **FireEye Mandiant:** Detailed threat actor profiles with CVE mappings
- **IBM X-Force:** Threat intelligence feeds with actor attribution

### Academic Access
- **MITRE Engage:** Enhanced datasets for research institutions
- **NIST Vulnerability Database:** Full API access for research purposes
- **Cyber Threat Intelligence Sharing Programs:** Government and academic partnerships

---

*Last Updated: January 2025*
*Note: Always verify data licensing and usage terms before implementing in production systems.*